<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Landry Pierrefitte">
    <title>Teledeck Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="icon" href="/static/dashboard/favicon/favicon.svg">
    <link href="/static/dashboard/styles/styles.css" rel="stylesheet">
    <script type="module" src="/static/dashboard/scripts/main.js" defer=""></script>
    <script>const data = {{ messages_data|safe }};</script>
  </head>
  <body>
    {% load static %}
    {% load crispy_forms_tags %}
    <main class="d-flex flex-nowrap" id="main">
      <div class="d-flex flex-column flex-shrink-0 p-3 text-bg-dark" style="width: 240px;">
        <div class="d-flex align-items-center text-white mb-3 mb-md-0 me-md-auto user-select-none">
          <img class="bi pe-none me-2" width="40" height="32" src="{% static 'dashboard/images/logo.svg' %}"></img>
          <span class="fs-4">Teledeck</span>
        </div>
        <hr>
        <div class="container-fluid">
          <div class="navbar-nav navbar-dark bg-dark" id="navbarColor01">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item" id="nav-general">
                <div class="nav-link user-select-none">
                  <img class="bi pe-none me-2" width="16" height="16" src="{% static 'dashboard/images/home.svg' %}"></img>
                  Vue générale
                </div>
              </li>
              <li class="nav-item" id="nav-sources">
                <div class="nav-link user-select-none">
                  <img class="bi pe-none me-2" width="16" height="16" src="{% static 'dashboard/images/sources.svg' %}"></img>
                  Sources
                </div>
              </li>
              <li class="nav-item" id="nav-filtres">
                <div class="nav-link user-select-none">
                  <img class="bi pe-none me-2" width="16" height="16" src="{% static 'dashboard/images/search.svg' %}"></img>
                  Filtres
                </div>
              </li>
              <li class="nav-item" id="nav-messages">
                <div class="nav-link user-select-none">
                  <img class="bi pe-none me-2" width="16" height="16" src="{% static 'dashboard/images/messages.svg' %}"></img>
                  Messages
                </div>
              </li>
              <li class="nav-item" id="nav-details">
                <div class="nav-link user-select-none">
                  <img class="bi pe-none me-2" width="16" height="16" src="{% static 'dashboard/images/details.svg' %}"></img>
                  Détails
                </div>
              </li>
            </ul>
          </div>
        </div>
        <div class="dropdown mt-auto">
          <a href="#" class="d-flex align-items-center text-white text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
            <img src="https://avatars.githubusercontent.com/u/99245328?s=96&v=4" alt="" width="32" height="32" class="rounded-circle me-2">
            <strong>Landry Pierrefitte</strong>
          </a>
          <ul class="dropdown-menu dropdown-menu-dark text-small shadow">
            <li><a class="dropdown-item" href="#">New project...</a></li>
            <li><a class="dropdown-item" href="#">Settings</a></li>
            <li><a class="dropdown-item" href="#">Profile</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#">Sign out</a></li>
          </ul>
        </div>
      </div>

      <div class="b-example-divider b-example-vr"></div>

      <div class="d-flex flex-column flex-shrink-0 p-3 bg-light" style="width: 280px;" id="sources">
        <div class="d-flex align-items-center mb-3 mb-md-0 me-md-auto user-select-none">
          <img class="bi pe-none me-2" width="30" height="24" src="{% static 'dashboard/images/sources.svg' %}" style="filter: invert(1);"></img>
          <span class="fs-4">Sources</span>
        </div>
        <hr>
        <ul class="list-unstyled ps-0">
          {% for group in groups %}
            <li class="mb-1">
              <span class="d-flex justify-content-between align-items-center nowrap">
                <button class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed bg-transparent" data-bs-toggle="collapse" data-bs-target="#{{ group.channel_group }}-collapse" aria-expanded="false">
                  {{ group.channel_group }}
                </button>
                <form class="form-check form-switch">
                  {% if group.group_toggle == True %}
                    <input class="form-check-input" type="checkbox" role="switch" type="submit" id="flexSwitchCheckDefault" checked>
                  {% elif group.group_toggle == False %}
                    <input class="form-check-input" type="checkbox" role="switch" type="submit" id="flexSwitchCheckDefault">
                  {% endif %}
                </form>
              </span>
              <div class="collapse" id="{{ group.channel_group }}-collapse">
                <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                  {% for channel in channels %}
                    {% if channel.channel_group == group.channel_group %}
                      <li>
                        <span class="d-flex justify-content-between nowrap">
                          {% if channel.channel_toggle == True %}
                            <a href="{% url 'toggle-channel' channel.channel_name %}" class="link-dark text-decoration-none rounded ellipsis bg-selected">{{ channel.channel_name }}</a>
                          {% elif channel.channel_toggle == False %}
                            <a href="{% url 'toggle-channel' channel.channel_name %}" class="link-dark text-decoration-none rounded ellipsis bg-transparent">{{ channel.channel_name }}</a>
                          {% endif %}
                          <a href="{% url 'delete-channel' channel.channel_name %}" class="bg-transparent">
                            <img class="bi pe-none me-2" width="14" height="14" src="{% static 'dashboard/images/delete.svg' %}" style="filter: invert(1);"></img>
                          </a>
                        </span>
                      </li>
                    {% endif %}
                  {% endfor %}
                </ul>
              </div>
            </li>
          {% endfor %}
        </ul>

        <hr>

        <p>
          <button class="d-flex btn btn-secondary d-flex align-items-center" type="button" data-bs-toggle="collapse" data-bs-target="#add-source" aria-expanded="false" aria-controls="add-source">
            <span class="fs-6 me-3">Add source</span>
            <img class="bi pe-none" width="16" height="16" src="{% static 'dashboard/images/menu.svg' %}"></img>
          </button>
        </p>
        <div class="row">
          <div class="col">
            <div class="collapse" id="add-source">
              <form action="add-channel" method="post">
                {% csrf_token %}
                {{ form|crispy }}
                <input class="btn btn-secondary mt-3 fs-3 p-1" type="submit" value="+" data-bs-toggle="collapse" data-bs-target="#add-source" aria-expanded="false" aria-controls="add-source"></input>
              </form>
            </div>
          </div>
        </div>
      </div>

      <div class="b-example-divider b-example-vr"></div>

      <div class="d-flex flex-column align-items-stretch flex-shrink-0 bg-white" style="width: 380px;" id="filtres">
        <div class="d-flex align-items-center flex-shrink-0 p-3 user-select-none border-bottom">
          <img class="bi pe-none me-2" width="30" height="24" src="{% static 'dashboard/images/search.svg' %}" style="filter: invert(1);"></img>
          <span class="fs-4">Filtres</span>
        </div>
      </div>

      <div class="b-example-divider b-example-vr"></div>

      <div class="d-flex flex-column align-items-stretch flex-shrink-0 bg-white" style="width: 380px;" id="messages">
        <div class="d-flex align-items-center flex-shrink-0 p-3 user-select-none border-bottom">
          <img class="bi pe-none me-2" width="30" height="24" src="{% static 'dashboard/images/messages.svg' %}" style="filter: invert(1);"></img>
          <span class="fs-4">Messages</span>
        </div>
        <div class="list-group list-group-flush border-bottom scrollarea">
          {% if messages %}
            {% for message in messages %}
              <div value="{{ message.id }}" class="zindex-popover list-group-item list-group-item-action p-2 lh-sm" id="message-container" aria-current="true">
                <div class="d-flex w-100 align-items-center justify-content-between">
                  <strong class="mb-1 text-truncate smaller">{{ message.channel_name }}</strong>
                  <a href="https://t.me/{{ message.channel_name }}/{{ message.message_id }}" class="text-muted text-decoration-none">
                    <small class="text-muted smaller">{{ message.message_date }}</small>
                  </a>
                </div>
                <span class="d-flex align-items-center justify-content-end">
                  <div class="text-muted smaller me-1">
                    {{ message.view_count }}
                  </div>
                  <img class="bi pe-none me-2" width="12" height="12" src="{% static 'dashboard/images/views.svg' %}" style="filter: invert(1);"></img>
                  <div class="text-muted smaller me-1">
                    {{ message.share_count }}
                  </div>
                  <img class="bi pe-none" width="12" height="12" src="{% static 'dashboard/images/shares.svg' %}" style="filter: invert(1);"></img>
                </span>
                {% if message.message_text %}
                  <div class="mt-3 smaller text-truncate">
                      {{ message.message_text }}
                  </div>
                  <div class="mt-2 mb-2 smaller text-truncate text-muted fst-italic">
                    Traduction : {{ message.text_translation }}
                  </div>
                {% else %}
                  <div class="mb-1 smaller">
                    Entry does not contain any text
                  </div>
                {% endif %}
              </div>
            {% endfor %}
          {% else %}
              <p>No message available.</p>
          {% endif %}
        </div>
      </div>

      <div class="b-example-divider b-example-vr"></div>
    
      <div class="d-flex flex-column align-items-stretch flex-shrink-0 bg-white" style="width: 500px;" id="details">
        <div class="d-flex align-items-center flex-shrink-0 p-3 user-select-none border-bottom">
          <img class="bi pe-none me-2" width="30" height="24" src="{% static 'dashboard/images/details.svg' %}" style="filter: invert(1);"></img>
          <span class="fs-4">Détails</span>
        </div>
        <div id="message-detail" class="p-4 scrollarea">
        </div>
      </div>
    
      <div class="b-example-divider b-example-vr"></div>

    </main>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
  </body>
</html>